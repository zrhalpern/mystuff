# Proactively engineered an automated resolution for a common issue that resulted in lost user data leveraging Intune Scripts and Remediations to enforce OneDrive deployment across the enterprise.
# Enhanced data protection protocols by modifying Intune configuration policies to mandate the "Start OneDrive automatically when signing in to Windows (User)" setting, ensuring consistent synchronization and preventing potential data loss.

  onedrive_detection.ps1
    # Detection script for proactive remediation of onedrive
    # Detects if OneDrive sync is disabled via policy
    # HKLM\Software\Policies\Microsoft\Windows\OneDrive\DisableFileSyncNGSC

    $RegPath = "HKLM:\Software\Policies\Microsoft\Windows\OneDrive"
    $ValueName = "DisableFileSyncNGSC"

    # Assigns the $Value the $ValueName value. 
    $Value = (Get-ItemProperty -Path $RegPath -Name $ValueName -ErrorAction SilentlyContinue).$ValueName

    # If $Value is equal to 1 (meaning onedrive is disabled) remediation script will run. 
    if ($Value -eq 1) {
         Write-Output "DisableFileSyncNGSC is set to 1. Issue detected."
         exit 1
    }

    Write-Output "DisableFileSyncNGSC is set to 0. No issue detected."
    exit 0

  onedrive_remediation.ps1
    $RegPath = "HKLM:\Software\Policies\Microsoft\Windows\OneDrive"
    $ValueName = "DisableFileSyncNGSC"
    $Value = 0

    Set-ItemProperty -Path $RegPath -Name $Valuename -Value $Value -Type DWord -Force
